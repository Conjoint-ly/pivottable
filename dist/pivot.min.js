!function(){var Z=[].indexOf,tt={}.hasOwnProperty,t=function(G){var W,i,t,n=function(t,e,n){for(var r=(t=(t+="").split("."))[0],n=1<t.length?n+t[1]:"",a=/(\d+)(\d{3})/;a.test(r);)r=r.replace(a,"$1"+e+"$2");return r+n},e=function(e){return e=G.extend({},{digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:""},e),function(t){return isNaN(t)||!isFinite(t)?"":(t=n((e.scaler*t).toFixed(e.digitsAfterDecimal),e.thousandsSep,e.decimalSep),""+e.prefix+t+e.suffix)}},r=e(),l=e({digitsAfterDecimal:0}),o=e({digitsAfterDecimal:1,scaler:100,suffix:"%"}),u={count:function(r=l){return function(){return function(t,e,n){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:r}}}},uniques:function(a,s=l){return function([r]){return function(t,e,n){return{uniq:[],push:function(t){var e=t[r];if(Z.call(this.uniq,e)<0)return this.uniq.push(t[r])},value:function(){return a(this.uniq)},format:s,numInputs:null!=r?0:1}}}},sum:function(a=r){return function([r]){return function(t,e,n){return{sum:0,push:function(t){if(!isNaN(parseFloat(t[r])))return this.sum+=parseFloat(t[r])},value:function(){return this.sum},format:a,numInputs:null!=r?0:1}}}},extremes:function(a,s=r){return function([r]){return function(t,e,n){return{val:null,sorter:Y(null!=t?t.sorters:void 0,r),push:function(t){var e,t=t[r];if("min"!==a&&"max"!==a||(t=parseFloat(t),isNaN(t))||(this.val=Math[a](t,null!=(e=this.val)?e:t)),"first"===a&&this.sorter(t,null!=(e=this.val)?e:t)<=0&&(this.val=t),"last"===a&&0<=this.sorter(t,null!=(e=this.val)?e:t))return this.val=t},value:function(){return this.val},format:function(t){return isNaN(t)?t:s(t)},numInputs:null!=r?0:1}}}},quantile:function(a,s=r){return function([r]){return function(t,e,n){return{vals:[],push:function(t){t=parseFloat(t[r]);if(!isNaN(t))return this.vals.push(t)},value:function(){var t;return 0===this.vals.length?null:(this.vals.sort(function(t,e){return t-e}),t=(this.vals.length-1)*a,(this.vals[Math.floor(t)]+this.vals[Math.ceil(t)])/2)},format:s,numInputs:null!=r?0:1}}}},runningStat:function(a="mean",s=1,l=r){return function([r]){return function(t,e,n){return{n:0,m:0,s:0,push:function(t){var e,t=parseFloat(t[r]);if(!isNaN(t))return this.n+=1,1===this.n?this.m=t:(e=this.m+(t-this.m)/this.n,this.s=this.s+(t-this.m)*(t-e),this.m=e)},value:function(){if("mean"===a)return 0===this.n?NaN:this.m;if(this.n<=s)return 0;switch(a){case"var":return this.s/(this.n-s);case"stdev":return Math.sqrt(this.s/(this.n-s))}},format:l,numInputs:null!=r?0:1}}}},sumOverSum:function(s=r){return function([r,a]){return function(t,e,n){return{sumNum:0,sumDenom:0,push:function(t){if(isNaN(parseFloat(t[r]))||(this.sumNum+=parseFloat(t[r])),!isNaN(parseFloat(t[a])))return this.sumDenom+=parseFloat(t[a])},value:function(){return this.sumNum/this.sumDenom},format:s,numInputs:null!=r&&null!=a?0:2}}}},sumOverSumBound80:function(s=!0,l=r){return function([r,a]){return function(t,e,n){return{sumNum:0,sumDenom:0,push:function(t){if(isNaN(parseFloat(t[r]))||(this.sumNum+=parseFloat(t[r])),!isNaN(parseFloat(t[a])))return this.sumDenom+=parseFloat(t[a])},value:function(){return(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*(s?1:-1)*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:l,numInputs:null!=r&&null!=a?0:2}}}},fractionOf:function(a,s="total",l=o){return function(...r){return function(t,e,n){return{selector:{total:[[],[]],row:[e,[]],col:[[],n]}[s],inner:a(...r)(t,e,n),push:function(t){return this.inner.push(t)},format:l,value:function(){return this.inner.value()/t.getAggregator(...this.selector).inner.value()},numInputs:a(...r)().numInputs}}}},countUnique:function(t){return u.uniques(function(t){return t.length},t)},listUnique:function(e){return u.uniques(function(t){return t.sort(Q).join(e)},function(t){return t})},max:function(t){return u.extremes("max",t)},min:function(t){return u.extremes("min",t)},first:function(t){return u.extremes("first",t)},last:function(t){return u.extremes("last",t)},median:function(t){return u.quantile(.5,t)},average:function(t){return u.runningStat("mean",1,t)},var:function(t,e){return u.runningStat("var",t,e)},stdev:function(t,e){return u.runningStat("stdev",t,e)}},a={Count:(a=u).count(l),"Count Unique Values":a.countUnique(l),"List Unique Values":a.listUnique(", "),Sum:a.sum(r),"Integer Sum":a.sum(l),Average:a.average(r),Median:a.median(r),"Sample Variance":a.var(1,r),"Sample Standard Deviation":a.stdev(1,r),Minimum:a.min(r),Maximum:a.max(r),First:a.first(r),Last:a.last(r),"Sum over Sum":a.sumOverSum(r),"80% Upper Bound":a.sumOverSumBound80(!0,r),"80% Lower Bound":a.sumOverSumBound80(!1,r),"Sum as Fraction of Total":a.fractionOf(a.sum(),"total",o),"Sum as Fraction of Rows":a.fractionOf(a.sum(),"row",o),"Sum as Fraction of Columns":a.fractionOf(a.sum(),"col",o),"Count as Fraction of Total":a.fractionOf(a.count(),"total",o),"Count as Fraction of Rows":a.fractionOf(a.count(),"row",o),"Count as Fraction of Columns":a.fractionOf(a.count(),"col",o)},c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p=function(t){return("0"+t).substr(-2,2)},h=/(\d+)|(\D+)/g,f=/\d/,g=/^0/,Q=(t,e)=>{var n,r,a,s,l,o;if(null!=e&&null==t)return-1;if(null!=t&&null==e)return 1;if("number"==typeof t&&isNaN(t))return-1;if("number"==typeof e&&isNaN(e))return 1;if((l=+t)<(o=+e))return-1;if(o<l)return 1;if("number"==typeof t&&"number"!=typeof e)return-1;if("number"==typeof e&&"number"!=typeof t)return 1;if("number"==typeof t&&"number"==typeof e)return 0;if(isNaN(o)&&!isNaN(l))return-1;if(isNaN(l)&&!isNaN(o))return 1;if((n=String(t))===(a=String(e)))return 0;if(!f.test(n)||!f.test(a))return a<n?1:-1;for(n=n.match(h),a=a.match(h);n.length&&a.length;)if((r=n.shift())!==(s=a.shift()))return f.test(r)&&f.test(s)?r.replace(g,".0")-s.replace(g,".0"):s<r?1:-1;return n.length-a.length},Y=function(t,e){var n;if(null!=t)if(G.isFunction(t)){if(n=t(e),G.isFunction(n))return n}else if(null!=t[e])return t[e];return Q},X=class X{constructor(t,e={}){this.arrSort=this.arrSort.bind(this),this.sortKeys=this.sortKeys.bind(this),this.getColKeys=this.getColKeys.bind(this),this.getRowKeys=this.getRowKeys.bind(this),this.getAggregator=this.getAggregator.bind(this),this.input=t,this.aggregator=null!=(t=e.aggregator)?t:u.count()(),this.aggregatorName=null!=(t=e.aggregatorName)?t:"Count",this.colAttrs=null!=(t=e.cols)?t:[],this.rowAttrs=null!=(t=e.rows)?t:[],this.valAttrs=null!=(t=e.vals)?t:[],this.sorters=null!=(t=e.sorters)?t:{},this.rowOrder=null!=(t=e.rowOrder)?t:"key_a_to_z",this.colOrder=null!=(t=e.colOrder)?t:"key_a_to_z",this.derivedAttributes=null!=(t=e.derivedAttributes)?t:{},this.filter=null!=(t=e.filter)?t:function(){return!0},this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.sorted=!1,X.forEachRecord(this.input,this.derivedAttributes,t=>{if(this.filter(t))return this.processRecord(t)})}static forEachRecord(t,r,a){var e,n,s,l,o,i,u,c,d,p,h,f=G.isEmptyObject(r)?a:function(t){var e,n;for(e in r)n=r[e],t[e]=null!=(n=n(t))?n:t[e];return a(t)};if(G.isFunction(t))return t(f);if(G.isArray(t)){if(G.isArray(t[0])){for(n in d=[],t)if(tt.call(t,n)&&(e=t[n],0<n)){for(s in u={},c=t[0])tt.call(c,s)&&(l=c[s],u[l]=e[s]);d.push(f(u))}return d}for(p=[],o=0,i=t.length;o<i;o++)u=t[o],p.push(f(u));return p}if(t instanceof G)return h=[],G("thead > tr > th",t).each(function(t){return h.push(G(this).text())}),G("tbody > tr",t).each(function(t){return u={},G("td",this).each(function(t){return u[h[t]]=G(this).text()}),f(u)});throw new Error("unknown input format")}forEachMatchingRecord(r,a){return X.forEachRecord(this.input,this.derivedAttributes,t=>{var e,n;if(this.filter(t)){for(e in r)if(r[e]!==(null!=(n=t[e])?n:"null"))return;return a(t)}})}arrSort(r){var a,s=function(){for(var t=[],e=0,n=r.length;e<n;e++)a=r[e],t.push(Y(this.sorters,a));return t}.call(this);return function(t,e){var n,r;for(r in s)if(tt.call(s,r)&&0!==(n=(0,s[r])(t[r],e[r])))return n;return 0}}sortKeys(){var n;if(!this.sorted){switch(this.sorted=!0,n=(t,e)=>this.getAggregator(t,e).value(),this.rowOrder){case"value_a_to_z":this.rowKeys.sort((t,e)=>Q(n(t,[]),n(e,[])));break;case"value_z_to_a":this.rowKeys.sort((t,e)=>-Q(n(t,[]),n(e,[])));break;default:this.rowKeys.sort(this.arrSort(this.rowAttrs))}switch(this.colOrder){case"value_a_to_z":return this.colKeys.sort((t,e)=>Q(n([],t),n([],e)));case"value_z_to_a":return this.colKeys.sort((t,e)=>-Q(n([],t),n([],e)));default:return this.colKeys.sort(this.arrSort(this.colAttrs))}}}getColKeys(){return this.sortKeys(),this.colKeys}getRowKeys(){return this.sortKeys(),this.rowKeys}processRecord(t){for(var e,n,r,a,s,l,o,i,u=[],c=[],d=this.colAttrs,p=0,h=d.length;p<h;p++)i=d[p],u.push(null!=(s=t[i])?s:"null");for(a=0,r=(l=this.rowAttrs).length;a<r;a++)i=l[a],c.push(null!=(o=t[i])?o:"null");if(n=c.join(String.fromCharCode(0)),e=u.join(String.fromCharCode(0)),this.allTotal.push(t),0!==c.length&&(this.rowTotals[n]||(this.rowKeys.push(c),this.rowTotals[n]=this.aggregator(this,c,[])),this.rowTotals[n].push(t)),0!==u.length&&(this.colTotals[e]||(this.colKeys.push(u),this.colTotals[e]=this.aggregator(this,[],u)),this.colTotals[e].push(t)),0!==u.length&&0!==c.length)return this.tree[n]||(this.tree[n]={}),this.tree[n][e]||(this.tree[n][e]=this.aggregator(this,c,u)),this.tree[n][e].push(t)}getAggregator(t,e){var n=t.join(String.fromCharCode(0)),r=e.join(String.fromCharCode(0)),t=0===t.length&&0===e.length?this.allTotal:0===t.length?this.colTotals[r]:0===e.length?this.rowTotals[n]:this.tree[n][r];return null!=t?t:{value:function(){return null},format:function(){return""}}}};return G.pivotUtilities={aggregatorTemplates:u,aggregators:a,renderers:t={Table:function(t,e){return i(t,e)},"Table Barchart":function(t,e){return G(i(t,e)).barchart()},Heatmap:function(t,e){return G(i(t,e)).heatmap("heatmap",e)},"Row Heatmap":function(t,e){return G(i(t,e)).heatmap("rowheatmap",e)},"Col Heatmap":function(t,e){return G(i(t,e)).heatmap("colheatmap",e)}},derivers:{bin:function(e,n){return function(t){return t[e]-t[e]%n}},dateFormat:function(e,r,t=!1,a=c,s=d){var l=t?"UTC":"";return function(t){var n=new Date(Date.parse(t[e]));return isNaN(n)?"":r.replace(/%(.)/g,function(t,e){switch(e){case"y":return n[`get${l}FullYear`]();case"m":return p(n[`get${l}Month`]()+1);case"n":return a[n[`get${l}Month`]()];case"d":return p(n[`get${l}Date`]());case"w":return s[n[`get${l}Day`]()];case"x":return n[`get${l}Day`]();case"H":return p(n[`get${l}Hours`]());case"M":return p(n[`get${l}Minutes`]());case"S":return p(n[`get${l}Seconds`]());default:return"%"+e}})}}},locales:W={en:{aggregators:a,renderers:t,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter values",apply:"Apply",cancel:"Cancel",totals:"Totals",vs:"vs",by:"by"}}},naturalSort:Q,numberFormat:e,sortAs:function(t){var e,n,r={},a={};for(e in t)n=t[e],r[n]=e,"string"==typeof n&&(a[n.toLowerCase()]=e);return function(t,e){return null!=r[t]&&null!=r[e]?r[t]-r[e]:null!=r[t]?-1:null!=r[e]?1:null!=a[t]&&null!=a[e]?a[t]-a[e]:null!=a[t]?-1:null!=a[e]?1:Q(t,e)}},PivotData:X},i=function(l,o){var t,e,i,n,r,a,s,u,c,d,p,h,f,g,m,v,b,C,w,y,x,A,S,T,N;for(u in o=G.extend(!0,{},{table:{clickCallback:null,rowTotals:!0,colTotals:!0},localeStrings:{totals:"Totals"}},o),i=l.colAttrs,f=l.rowAttrs,m=l.getRowKeys(),r=l.getColKeys(),o.table.clickCallback&&(a=function(e,t,n){var r,a,s={};for(a in i)tt.call(i,a)&&(r=i[a],null!=n[a])&&(s[r]=n[a]);for(a in f)tt.call(f,a)&&(r=f[a],null!=t[a])&&(s[r]=t[a]);return function(t){return o.table.clickCallback(t,e,s,l)}}),(h=document.createElement("table")).className="pvtTable",v=function(t,e,n){var r,a,s,l,o,i,u,c;if(0!==e){for(l=!0,c=r=0,o=n;0<=o?r<=o:o<=r;c=0<=o?++r:--r)t[e-1][c]!==t[e][c]&&(l=!1);if(l)return-1}for(a=0;e+a<t.length;){for(u=!1,c=s=0,i=n;0<=i?s<=i:i<=s;c=0<=i?++s:--s)t[e][c]!==t[e+a][c]&&(u=!0);if(u)break;a++}return a},y=document.createElement("thead"),i)if(tt.call(i,u)){for(s in e=i[u],A=document.createElement("tr"),0===parseInt(u)&&0!==f.length&&((w=document.createElement("th")).setAttribute("colspan",f.length),w.setAttribute("rowspan",i.length),A.appendChild(w)),(w=document.createElement("th")).className="pvtAxisLabel",w.textContent=null!=(d=o.labels[e])?d:e,A.appendChild(w),r)tt.call(r,s)&&(n=r[s],-1!==(N=v(r,parseInt(s),parseInt(u))))&&((w=document.createElement("th")).className="pvtColLabel",w.textContent=n[u],w.setAttribute("colspan",N),parseInt(u)===i.length-1&&0!==f.length&&w.setAttribute("rowspan",2),A.appendChild(w));0===parseInt(u)&&o.table.rowTotals&&((w=document.createElement("th")).className="pvtTotalLabel pvtRowTotalLabel",w.innerHTML=o.localeStrings.totals,w.setAttribute("rowspan",i.length+(0===f.length?0:1)),A.appendChild(w)),y.appendChild(A)}if(0!==f.length){for(s in A=document.createElement("tr"),f)tt.call(f,s)&&(c=f[s],(w=document.createElement("th")).className="pvtAxisLabel",w.textContent=null!=(p=o.labels[c])?p:c,A.appendChild(w));w=document.createElement("th"),0===i.length&&(w.className="pvtTotalLabel pvtRowTotalLabel",w.innerHTML=o.localeStrings.totals),A.appendChild(w),y.appendChild(A)}for(s in h.appendChild(y),b=document.createElement("tbody"),m)if(tt.call(m,s)){for(u in g=m[s],A=document.createElement("tr"),g)tt.call(g,u)&&(S=g[u],-1!==(N=v(m,parseInt(s),parseInt(u))))&&((w=document.createElement("th")).className="pvtRowLabel",w.textContent=S,w.setAttribute("rowspan",N),parseInt(u)===f.length-1&&0!==i.length&&w.setAttribute("colspan",2),A.appendChild(w));for(u in r)tt.call(r,u)&&(n=r[u],T=(t=l.getAggregator(g,n)).value(),(C=document.createElement("td")).className=`pvtVal row${s} col`+u,C.textContent=t.format(T),C.setAttribute("data-value",T),null!=a&&(C.onclick=a(T,g,n)),A.appendChild(C));!o.table.rowTotals&&0!==i.length||(T=(x=l.getAggregator(g,[])).value(),(C=document.createElement("td")).className="pvtTotal rowTotal",C.textContent=x.format(T),C.setAttribute("data-value",T),null!=a&&(C.onclick=a(T,g,[])),C.setAttribute("data-for","row"+s),A.appendChild(C)),b.appendChild(A)}if(o.table.colTotals||0===f.length){for(u in A=document.createElement("tr"),!o.table.colTotals&&0!==f.length||((w=document.createElement("th")).className="pvtTotalLabel pvtColTotalLabel",w.innerHTML=o.localeStrings.totals,w.setAttribute("colspan",f.length+(0===i.length?0:1)),A.appendChild(w)),r)tt.call(r,u)&&(n=r[u],T=(x=l.getAggregator([],n)).value(),(C=document.createElement("td")).className="pvtTotal colTotal",C.textContent=x.format(T),C.setAttribute("data-value",T),null!=a&&(C.onclick=a(T,[],n)),C.setAttribute("data-for","col"+u),A.appendChild(C));!o.table.rowTotals&&0!==i.length||(T=(x=l.getAggregator([],[])).value(),(C=document.createElement("td")).className="pvtGrandTotal",C.textContent=x.format(T),C.setAttribute("data-value",T),null!=a&&(C.onclick=a(T,[],[])),A.appendChild(C)),b.appendChild(A)}return h.appendChild(b),h.setAttribute("data-numrows",m.length),h.setAttribute("data-numcols",r.length),h},G.fn.pivot=function(t,e,n="en"){var r,a,s,l,o;null==W[n]&&(n="en"),r={cols:[],rows:[],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",dataClass:X,filter:function(){return!0},aggregator:u.count()(),aggregatorName:"Count",sorters:{},labels:{},derivedAttributes:{},renderer:i},l={rendererOptions:{localeSettings:n=G.extend(!0,{},W.en.localeStrings,W[n].localeStrings),labels:null!=(l=e.labels)?l:{}},localeStrings:n},n=G.extend(!0,{},l,G.extend({},r,e)),l=null;try{s=new n.dataClass(t,n);try{l=n.renderer(s,n.rendererOptions)}catch(t){a=t,"undefined"!=typeof console&&null!==console&&console.error(a.stack),l=G("<span>").html(n.localeStrings.renderError)}}catch(t){a=t,"undefined"!=typeof console&&null!==console&&console.error(a.stack),l=G("<span>").html(n.localeStrings.computeError)}for(o=this[0];o.hasChildNodes();)o.removeChild(o.lastChild);return l},G.fn.pivotUI=function(L,M,K=!1,t="en"){var e,g,m,w,r,v,n,y,b,a,s,l,C,x,o,q,i,z,A,u,V,$,c,d,S,B,T,N,j,k,p,h,_,f,O,H,F,D,R,U,E,P={derivedAttributes:{},aggregators:W[t=null==W[t]?"en":t].aggregators,renderers:W[t].renderers,hiddenAttributes:[],hiddenFromAggregators:[],hiddenFromDragDrop:[],menuLimit:500,cols:[],rows:[],vals:[],rowOrder:"key_a_to_z",colOrder:"key_a_to_z",dataClass:X,exclusions:{},inclusions:{},unusedAttrsVertical:85,autoSortUnusedAttrs:!1,onRefresh:null,showUI:!0,labels:{},controls:{unused:!1,rules:!1},filter:function(){return!0},sorters:{}},t={rendererOptions:{localeStrings:C=G.extend(!0,{},W.en.localeStrings,W[t].localeStrings)},localeStrings:C},J=this.data("pivotUIOptions"),I=null==J||K?G.extend(!0,{},t,G.extend({},P,M)):J;try{for(E in w={},x=[],u=0,X.forEachRecord(L,I.derivedAttributes,function(t){var e,n,r;if(I.filter(t)){for(e in x.push(t),t)tt.call(t,e)&&null==w[e]&&(w[e]={},0<u)&&(w[e].null=u);for(e in w)r=null!=(r=t[e])?r:"null",null==(n=w[e])[r]&&(n[r]=0),w[e][r]++;return u++}}),F=G("<table>",{class:"pvtUi"}).attr("cellpadding",5),N=G("<td>",{colspan:"3",class:"pvtUiCell pvtUiControls"}),T=G("<select>").addClass("pvtRenderer").appendTo(N).bind("change",function(){return S()}),V=I.renderers)tt.call(V,E)&&G("<option>").val(E).html(E).appendTo(T);for(y in D=G("<td>",{class:"pvtAxisContainer pvtUnused pvtUiCell"}),h=(()=>{var t=[];for(e in w)Z.call(I.hiddenAttributes,e)<0&&t.push(e);return t})(),_=(()=>{for(var t=[],e=0,n=h.length;e<n;e++)r=h[e],Z.call(I.hiddenFromAggregators,r)<0&&t.push(r);return t})(),f=(()=>{for(var t=[],e=0,n=h.length;e<n;e++)r=h[e],Z.call(I.hiddenFromDragDrop,r)<0&&t.push(r);return t})(),I.unusedAttrsVertical,D.addClass("pvtVertList"),f)tt.call(f,y)&&(e=>{var t,n,r,a,s,l,o,i,u,c,d,p,h,f=(()=>{var t=[];for(d in w[e])t.push(d);return t})(),g=!1,m=G("<div>",{class:"pvtFilterBox panel panel-default"}).hide(),v=G("<div>",{class:"panel-heading"}),b=G("<div>",{class:"panel-body"}),C=G("<div>",{class:"panel-footer"});if(m.append(v),m.append(b),m.append(C),v.append(G("<h4>",{class:"panel-title"}).append(G("<span>").text(null!=(v=I.labels[e])?v:e),G("<span>").addClass("count").text(`(${f.length})`))),f.length>I.menuLimit)m.append(G("<p>").html(I.localeStrings.tooMany));else for(5<f.length&&(v=G("<div>",{class:"input-group"}).appendTo(b),u=Y(I.sorters,e),c=I.localeStrings.filterResults,G("<input>").appendTo(v).attr({placeholder:c,class:"pvtSearch form-control input-sm",type:"text"}).bind("keyup",function(){var a=G(this).val().toLowerCase().trim(),t=function(n,r){return function(t){var e=a.substring(n.length).trim();return 0===e.length||(t=Math.sign(u(t.toLowerCase(),e)),0<=Z.call(r,t))}},e=0===a.indexOf(">=")?t(">=",[1,0]):0===a.indexOf("<=")?t("<=",[-1,0]):0===a.indexOf(">")?t(">",[1]):0===a.indexOf("<")?t("<",[-1]):0===a.indexOf("~")?function(t){return 0===a.substring(1).trim().length||t.toLowerCase().match(a.substring(1))}:function(t){return-1!==t.toLowerCase().indexOf(a)};return m.find(".pvtCheckContainer label span.value").each(function(){return e(G(this).text())?G(this).parent().parent().addClass("pvtFilterIn").show():G(this).parent().parent().removeClass("pvtFilterIn").hide()})}),c=G("<span>",{class:"input-group-btn"}).appendTo(v),G("<button>",{type:"button",class:"btn btn-default btn-sm",title:I.localeStrings.selectAll}).appendTo(c).append(G("<i>",{class:"far fa-fw fa-check-square"})).bind("click",function(){return m.find("input:visible:not(:checked)").prop("checked",!0).toggleClass("changed"),!1}),G("<button>",{type:"button",class:"btn btn-default btn-sm",title:I.localeStrings.selectNone}).appendTo(c).append(G("<i>",{class:"far fa-fw fa-square"})).bind("click",function(){return m.find("input:visible:checked").prop("checked",!1).toggleClass("changed"),!1})),n=G("<div>",{class:"pvtCheckContainer"}).appendTo(b),l=0,o=(i=f.sort(Y(I.sorters,e))).length;l<o;l++)p=i[l],h=w[e][p],a=G("<label>"),s=!1,I.inclusions[e]?s=Z.call(I.inclusions[e],p)<0:I.exclusions[e]&&(s=0<=Z.call(I.exclusions[e],p)),g=g||s,G("<input>").attr("type","checkbox").addClass("pvtFilter").attr("checked",!s).data("filter",[e,p]).appendTo(a).bind("change",function(){return G(this).toggleClass("changed")}),a.append(G("<span>").addClass("value").text(p)),a.append(G("<span>").addClass("count").text("("+h+")")),n.append(G("<div>",{class:"checkbox"}).append(a));r=function(){return m.find("[type='checkbox']").length>m.find("[type='checkbox']:checked").length?t.addClass("pvtFilteredAttribute"):t.removeClass("pvtFilteredAttribute"),m.find(".pvtSearch").val(""),m.find(".pvtCheckContainer div.checkbox").show(),m.hide()},v=G("<div>",{class:"text-right"}).appendTo(C),f.length<=I.menuLimit&&(G("<button>",{type:"button",class:"btn btn-default btn-sm"}).text(I.localeStrings.apply).appendTo(v).bind("click",function(){return m.find(".changed").removeClass("changed").length&&S(),r()}),G("<span>").html("&nbsp;").appendTo(v)),G("<button>",{type:"button",class:"btn btn-default btn-sm"}).text(I.localeStrings.cancel).appendTo(v).bind("click",function(){return m.find(".changed:checked").removeClass("changed").prop("checked",!1),m.find(".changed:not(:checked)").removeClass("changed").prop("checked",!0),r()}),c=G("<i>",{class:"fas fa-fw fa-caret-down"}).addClass("pvtTriangle").bind("click",function(t){var e=G(".pvtUi"),n=e.height(),e=e.offset(),t=G(t.currentTarget).offset(),r=m.height(),n=n-(t.top-e.top),n=r<n?t.top-e.top:r/2<n?t.top-e.top-r/2:t.top-e.top-r;return G(".pvtFilterBox").hide(),m.css({left:t.left-e.left+10,top:n+10}).show()}),t=G("<li>").addClass("axis_"+y).append(G("<span>").addClass("label label-default pvtAttr").attr("title",null!=(b=I.labels[e])?b:e).text(null!=(C=I.labels[e])?C:e).data("attrName",e).append(c)),g&&t.addClass("pvtFilteredAttribute"),D.append(t),N.append(m)})(m=f[y]);for(E in G("<tr>").appendTo(F),O=G("<tr>").appendTo(F),g=G("<select>").addClass("pvtAggregator").bind("change",function(){return S()}),$=I.aggregators)tt.call($,E)&&g.append(G("<option>").val(E).html(E));for(N.append(" ").append(g),i={key_a_to_z:{rowSymbol:G("<i>",{class:"far fa-fw fa-arrows-alt-v"}),colSymbol:G("<i>",{class:"far fa-fw fa-arrows-alt-h"}),next:"value_a_to_z"},value_a_to_z:{rowSymbol:G("<i>",{class:"far fa-fw fa-long-arrow-alt-down"}),colSymbol:G("<i>",{class:"far fa-fw fa-long-arrow-alt-right"}),next:"value_z_to_a"},value_z_to_a:{rowSymbol:G("<i>",{class:"far fa-fw fa-long-arrow-alt-up"}),colSymbol:G("<i>",{class:"far fa-fw fa-long-arrow-alt-left"}),next:"key_a_to_z"}},k=G("<button>",{class:"btn btn-default btn-xs"}).data("order",I.rowOrder).html(i[I.rowOrder].rowSymbol).bind("click",function(){return G(this).data("order",i[G(this).data("order")].next),G(this).html(i[G(this).data("order")].rowSymbol),S()}),v=G("<button>",{class:"btn btn-default btn-xs"}).data("order",I.colOrder).html(i[I.colOrder].colSymbol).bind("click",function(){return G(this).data("order",i[G(this).data("order")].next),G(this).html(i[G(this).data("order")].colSymbol),S()}),q=G("<div>",{class:"btn-group",role:"group"}).append(k).append(v),R=G("<button>",{class:"btn btn-default btn-xs"}).append(G("<i>",{class:"far fa-fw fa-ruler-vertical fa-flip-horizontal"})).bind("click",function(){var t;return G(this).toggleClass("active"),G(".pvtUnused").toggle(),"2"===(t=G(".pvtVals")).attr("colspan")?t.attr("colspan",1):t.attr("colspan",2)}),I.controls.unused&&R.addClass("active"),p=G("<button>",{class:"btn btn-default btn-xs"}).append(G("<i>",{class:"far fa-fw fa-ruler-combined fa-flip-vertical"})).bind("click",function(){return G(this).toggleClass("active"),G(".pvtRows, .pvtCols").toggle()}),I.controls.rules&&p.addClass("active"),z=G("<div>",{class:"btn-group",role:"group"}).append(R).append(p),n=G("<div>",{class:"btn-toolbar"}).append(z).append(q),G("<td>",{class:"pvtVals pvtUiCell"}).appendTo(O).append(n),G("<td>").addClass("pvtAxisContainer pvtHorizList pvtCols pvtUiCell").appendTo(O),(H=G("<tr>").appendTo(F)).append(G("<td>").addClass("pvtAxisContainer pvtRows pvtUiCell").attr("valign","top")),A=G("<td>").attr("valign","top").addClass("pvtRendererArea").appendTo(H),I.unusedAttrsVertical,F.find("tr:nth-child(1)").prepend(N),F.find("tr:nth-child(3)").prepend(D),U=G("<div>",{class:"pvtVisible"}),j=G("<div>",{class:"pvtResponsive"}).appendTo(U),F.appendTo(j),this.html(U),I.controls.rules||G(".pvtRows, .pvtCols").hide(),I.controls.unused||G(".pvtUnused").hide(),I.controls.unused&&G(".pvtVals").attr("colspan",2),c=I.cols,a=0,s=c.length;a<s;a++)E=c[a],this.find(".pvtCols").append(this.find(".axis_"+G.inArray(E,f)));for(d=I.rows,o=0,l=d.length;o<l;o++)E=d[o],this.find(".pvtRows").append(this.find(".axis_"+G.inArray(E,f)));null!=I.aggregatorName&&this.find(".pvtAggregator").val(I.aggregatorName),null!=I.rendererName&&this.find(".pvtRenderer").val(I.rendererName),I.showUI||this.find(".pvtUiCell").hide(),B=t=>{var a,e,n,r,s,l,o,i,u,c,d,p={derivedAttributes:I.derivedAttributes,localeStrings:I.localeStrings,rendererOptions:I.rendererOptions,sorters:I.sorters,labels:I.labels,cols:[],rows:[],dataClass:I.dataClass},h=null!=(c=I.aggregators[g.val()]([])().numInputs)?c:0,f=[];if(this.find(".pvtRows li span.pvtAttr").each(function(){return p.rows.push(G(this).data("attrName"))}),this.find(".pvtCols li span.pvtAttr").each(function(){return p.cols.push(G(this).data("attrName"))}),this.find(".pvtUiControls select.pvtAttrDropdown").each(function(){return 0===h?(G(this).prev(".pvtAttrDropdownBy").remove(),G(this).remove()):(h--,""!==G(this).val()?f.push(G(this).val()):void 0)}),0!==h)for(l=this.find(".pvtUiControls"),E=s=0,o=h;0<=o?s<o:o<s;E=0<=o?++s:--s){for(r=G("<select>").addClass("pvtAttrDropdown").append(G("<option>")).bind("change",function(){return S()}),u=0,n=_.length;u<n;u++)m=_[u],r.append(G("<option>").val(m).text(null!=(i=I.labels[m])?i:m));l.append(" ").append(G("<span>",{class:"pvtAttrDropdownBy"}).text(C.by)).append(" ").append(r)}if(b&&(f=I.vals,y=0,this.find(".pvtUiControls select.pvtAttrDropdown").each(function(){return G(this).val(f[y]),y++}),b=!1),p.aggregatorName=g.val(),p.vals=f,p.aggregator=I.aggregators[g.val()](f),p.renderer=I.renderers[T.val()],p.rowOrder=k.data("order"),p.colOrder=v.data("order"),a={},this.find("input.pvtFilter").not(":checked").each(function(){var t=G(this).data("filter");return null!=a[t[0]]?a[t[0]].push(t[1]):a[t[0]]=[t[1]]}),e={},this.find("input.pvtFilter:checked").each(function(){var t=G(this).data("filter");if(null!=a[t[0]])return null!=e[t[0]]?e[t[0]].push(t[1]):e[t[0]]=[t[1]]}),p.filter=function(t){var e,n,r;if(!I.filter(t))return!1;for(n in a)if(e=a[n],r=""+(null!=(r=t[n])?r:"null"),0<=Z.call(e,r))return!1;return!0},-1<["Line Chart","Bar Chart","Stacked Bar Chart","Area Chart","Scatter Chart","Pie Chart"].indexOf(T.val())?({result:c,wrapper:d}=A.pivot(x,p),A.append(c),d.draw(c[0])):A.append(A.pivot(x,p)),d=G.extend({},I,{cols:p.cols,rows:p.rows,colOrder:p.colOrder,rowOrder:p.rowOrder,vals:f,exclusions:a,inclusions:e,inclusionsInfo:e,aggregatorName:g.val(),rendererName:T.val()}),this.data("pivotUIOptions",d),I.autoSortUnusedAttrs&&(c=this.find("td.pvtUnused.pvtAxisContainer"),G(c).children("li").sort((t,e)=>Q(G(t).text(),G(e).text())).appendTo(c)),A.css("opacity",1),null!=I.onRefresh&&null==t)return I.onRefresh(d)},(S=t=>(A.css("opacity",.5),setTimeout(function(){return B(t)},10)))(b=!0),this.find(".pvtAxisContainer").sortable({update:function(t,e){if(null==e.sender)return S()},connectWith:this.find(".pvtAxisContainer"),items:"li",placeholder:"pvtPlaceholder"})}catch(t){"undefined"!=typeof console&&null!==console&&console.error(t.stack),this.html(I.localeStrings.uiRenderError)}return this},G.fn.heatmap=function(t="heatmap",e){var n,r,a,s,l,o,i,u=this.data("numrows"),c=this.data("numcols"),d=null!=e&&null!=(e=e.heatmap)?e.colorScaleGenerator:void 0;switch(null==d&&(d=function(t){var e=Math.min(...t),n=Math.max(...t);return function(t){t=255-Math.round(255*(t-e)/(n-e));return`rgb(255,${t},${t})`}}),n=t=>{var n,e=e=>this.find(t).each(function(){var t=G(this).data("value");if(null!=t&&isFinite(t))return e(t,G(this))}),r=[];return e(function(t){return r.push(t)}),n=d(r),e(function(t,e){return e.css("background-color",n(t))})},t){case"heatmap":n(".pvtVal");break;case"rowheatmap":for(r=s=0,o=u;0<=o?s<o:o<s;r=0<=o?++s:--s)n(".pvtVal.row"+r);break;case"colheatmap":for(a=l=0,i=c;0<=i?l<i:i<l;a=0<=i?++l:--l)n(".pvtVal.col"+a)}return n(".pvtTotal.rowTotal"),n(".pvtTotal.colTotal"),this},G.fn.barchart=function(t){for(var e,n=this.data("numrows"),r=(this.data("numcols"),t=>{var e,l,n,o,r=e=>this.find(t).each(function(){var t=G(this).data("value");if(null!=t&&isFinite(t))return e(t,G(this))}),a=[];return r(function(t){return a.push(t)}),e=Math.max(...a),n=e=e<0?0:e,(l=Math.min(...a))<0&&(n=e-l),o=function(t){return 100*t/(1.4*n)},r(function(t,e){var n=e.text(),r=G("<div>").css({position:"relative",height:"55px"}),a="gray",s=l<0?o(-l):0;return t<0&&(s+=o(t),a="darkred",t=-t),r.append(G("<div>").css({position:"absolute",bottom:s+"%",left:0,right:0,height:o(t)+"%","background-color":a})),r.append(G("<div>").text(n).css({position:"relative","padding-left":"5px","padding-right":"5px"})),e.css({padding:0,"padding-top":"5px","text-align":"center"}).html(r)})}),a=e=0,s=n;0<=s?e<s:s<e;a=0<=s?++e:--e)r(".pvtVal.row"+a);return r(".pvtTotal.colTotal"),this}};"object"==typeof exports&&"object"==typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}.call(this);
//# sourceMappingURL=pivot.min.js.map
